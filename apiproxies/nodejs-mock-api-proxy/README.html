<!DOCTYPE html><html><head><meta charset="utf-8"><style>body {
  width: 45em;
  border: 1px solid #ddd;
  outline: 1300px solid #fff;
  margin: 16px auto;
}

body .markdown-body
{
  padding: 30px;
}

@font-face {
  font-family: octicons-anchor;
  src: url(data:font/woff;charset=utf-8;base64,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) format('woff');
}

.markdown-body {
  -ms-text-size-adjust: 100%;
  -webkit-text-size-adjust: 100%;
  color: #333;
  overflow: hidden;
  font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif;
  font-size: 16px;
  line-height: 1.6;
  word-wrap: break-word;
}

.markdown-body a {
  background: transparent;
}

.markdown-body a:active,
.markdown-body a:hover {
  outline: 0;
}

.markdown-body strong {
  font-weight: bold;
}

.markdown-body h1 {
  font-size: 2em;
  margin: 0.67em 0;
}

.markdown-body img {
  border: 0;
}

.markdown-body hr {
  -moz-box-sizing: content-box;
  box-sizing: content-box;
  height: 0;
}

.markdown-body pre {
  overflow: auto;
}

.markdown-body code,
.markdown-body kbd,
.markdown-body pre {
  font-family: monospace, monospace;
  font-size: 1em;
}

.markdown-body input {
  color: inherit;
  font: inherit;
  margin: 0;
}

.markdown-body html input[disabled] {
  cursor: default;
}

.markdown-body input {
  line-height: normal;
}

.markdown-body input[type="checkbox"] {
  -moz-box-sizing: border-box;
  box-sizing: border-box;
  padding: 0;
}

.markdown-body table {
  border-collapse: collapse;
  border-spacing: 0;
}

.markdown-body td,
.markdown-body th {
  padding: 0;
}

.markdown-body * {
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}

.markdown-body input {
  font: 13px/1.4 Helvetica, arial, freesans, clean, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol";
}

.markdown-body a {
  color: #4183c4;
  text-decoration: none;
}

.markdown-body a:hover,
.markdown-body a:focus,
.markdown-body a:active {
  text-decoration: underline;
}

.markdown-body hr {
  height: 0;
  margin: 15px 0;
  overflow: hidden;
  background: transparent;
  border: 0;
  border-bottom: 1px solid #ddd;
}

.markdown-body hr:before {
  display: table;
  content: "";
}

.markdown-body hr:after {
  display: table;
  clear: both;
  content: "";
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
  margin-top: 15px;
  margin-bottom: 15px;
  line-height: 1.1;
}

.markdown-body h1 {
  font-size: 30px;
}

.markdown-body h2 {
  font-size: 21px;
}

.markdown-body h3 {
  font-size: 16px;
}

.markdown-body h4 {
  font-size: 14px;
}

.markdown-body h5 {
  font-size: 12px;
}

.markdown-body h6 {
  font-size: 11px;
}

.markdown-body blockquote {
  margin: 0;
}

.markdown-body ul,
.markdown-body ol {
  padding: 0;
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body ol ol,
.markdown-body ul ol {
  list-style-type: lower-roman;
}

.markdown-body ul ul ol,
.markdown-body ul ol ol,
.markdown-body ol ul ol,
.markdown-body ol ol ol {
  list-style-type: lower-alpha;
}

.markdown-body dd {
  margin-left: 0;
}

.markdown-body code {
  font: 12px Consolas, "Liberation Mono", Menlo, Courier, monospace;
}

.markdown-body pre {
  margin-top: 0;
  margin-bottom: 0;
  font: 12px Consolas, "Liberation Mono", Menlo, Courier, monospace;
}

.markdown-body .octicon {
  font: normal normal 16px octicons-anchor;
  line-height: 1;
  display: inline-block;
  text-decoration: none;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.markdown-body .octicon-link:before {
  content: '\f05c';
}

.markdown-body>*:first-child {
  margin-top: 0 !important;
}

.markdown-body>*:last-child {
  margin-bottom: 0 !important;
}

.markdown-body .anchor {
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  display: block;
  padding-right: 6px;
  padding-left: 30px;
  margin-left: -30px;
}

.markdown-body .anchor:focus {
  outline: none;
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
  position: relative;
  margin-top: 1em;
  margin-bottom: 16px;
  font-weight: bold;
  line-height: 1.4;
}

.markdown-body h1 .octicon-link,
.markdown-body h2 .octicon-link,
.markdown-body h3 .octicon-link,
.markdown-body h4 .octicon-link,
.markdown-body h5 .octicon-link,
.markdown-body h6 .octicon-link {
  display: none;
  color: #000;
  vertical-align: middle;
}

.markdown-body h1:hover .anchor,
.markdown-body h2:hover .anchor,
.markdown-body h3:hover .anchor,
.markdown-body h4:hover .anchor,
.markdown-body h5:hover .anchor,
.markdown-body h6:hover .anchor {
  padding-left: 8px;
  margin-left: -30px;
  line-height: 1;
  text-decoration: none;
}

.markdown-body h1:hover .anchor .octicon-link,
.markdown-body h2:hover .anchor .octicon-link,
.markdown-body h3:hover .anchor .octicon-link,
.markdown-body h4:hover .anchor .octicon-link,
.markdown-body h5:hover .anchor .octicon-link,
.markdown-body h6:hover .anchor .octicon-link {
  display: inline-block;
}

.markdown-body h1 {
  padding-bottom: 0.3em;
  font-size: 2.25em;
  line-height: 1.2;
  border-bottom: 1px solid #eee;
}

.markdown-body h2 {
  padding-bottom: 0.3em;
  font-size: 1.75em;
  line-height: 1.225;
  border-bottom: 1px solid #eee;
}

.markdown-body h3 {
  font-size: 1.5em;
  line-height: 1.43;
}

.markdown-body h4 {
  font-size: 1.25em;
}

.markdown-body h5 {
  font-size: 1em;
}

.markdown-body h6 {
  font-size: 1em;
  color: #777;
}

.markdown-body p,
.markdown-body blockquote,
.markdown-body ul,
.markdown-body ol,
.markdown-body dl,
.markdown-body table,
.markdown-body pre {
  margin-top: 0;
  margin-bottom: 16px;
}

.markdown-body hr {
  height: 4px;
  padding: 0;
  margin: 16px 0;
  background-color: #e7e7e7;
  border: 0 none;
}

.markdown-body ul,
.markdown-body ol {
  padding-left: 2em;
}

.markdown-body ul ul,
.markdown-body ul ol,
.markdown-body ol ol,
.markdown-body ol ul {
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body li>p {
  margin-top: 16px;
}

.markdown-body dl {
  padding: 0;
}

.markdown-body dl dt {
  padding: 0;
  margin-top: 16px;
  font-size: 1em;
  font-style: italic;
  font-weight: bold;
}

.markdown-body dl dd {
  padding: 0 16px;
  margin-bottom: 16px;
}

.markdown-body blockquote {
  padding: 0 15px;
  color: #777;
  border-left: 4px solid #ddd;
}

.markdown-body blockquote>:first-child {
  margin-top: 0;
}

.markdown-body blockquote>:last-child {
  margin-bottom: 0;
}

.markdown-body table {
  display: block;
  width: 100%;
  overflow: auto;
  word-break: normal;
  word-break: keep-all;
}

.markdown-body table th {
  font-weight: bold;
}

.markdown-body table th,
.markdown-body table td {
  padding: 6px 13px;
  border: 1px solid #ddd;
}

.markdown-body table tr {
  background-color: #fff;
  border-top: 1px solid #ccc;
}

.markdown-body table tr:nth-child(2n) {
  background-color: #f8f8f8;
}

.markdown-body img {
  max-width: 100%;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}

.markdown-body code {
  padding: 0;
  padding-top: 0.2em;
  padding-bottom: 0.2em;
  margin: 0;
  font-size: 85%;
  background-color: rgba(0,0,0,0.04);
  border-radius: 3px;
}

.markdown-body code:before,
.markdown-body code:after {
  letter-spacing: -0.2em;
  content: "\00a0";
}

.markdown-body pre>code {
  padding: 0;
  margin: 0;
  font-size: 100%;
  word-break: normal;
  white-space: pre;
  background: transparent;
  border: 0;
}

.markdown-body .highlight {
  margin-bottom: 16px;
}

.markdown-body .highlight pre,
.markdown-body pre {
  padding: 16px;
  overflow: auto;
  font-size: 85%;
  line-height: 1.45;
  background-color: #f7f7f7;
  border-radius: 3px;
}

.markdown-body .highlight pre {
  margin-bottom: 0;
  word-break: normal;
}

.markdown-body pre {
  word-wrap: normal;
}

.markdown-body pre code {
  display: inline;
  max-width: initial;
  padding: 0;
  margin: 0;
  overflow: initial;
  line-height: inherit;
  word-wrap: normal;
  background-color: transparent;
  border: 0;
}

.markdown-body pre code:before,
.markdown-body pre code:after {
  content: normal;
}

.markdown-body .highlight {
  background: #fff;
}

.markdown-body .highlight .h {
  color: #333;
  font-style: normal;
  font-weight: normal;
}

.markdown-body .highlight .mf,
.markdown-body .highlight .mh,
.markdown-body .highlight .mi,
.markdown-body .highlight .mo,
.markdown-body .highlight .il,
.markdown-body .highlight .m {
  color: #945277;
}

.markdown-body .highlight .s,
.markdown-body .highlight .sb,
.markdown-body .highlight .sc,
.markdown-body .highlight .sd,
.markdown-body .highlight .s2,
.markdown-body .highlight .se,
.markdown-body .highlight .sh,
.markdown-body .highlight .si,
.markdown-body .highlight .sx,
.markdown-body .highlight .s1 {
  color: #df5000;
}

.markdown-body .highlight .kc,
.markdown-body .highlight .kd,
.markdown-body .highlight .kn,
.markdown-body .highlight .kp,
.markdown-body .highlight .kr,
.markdown-body .highlight .kt,
.markdown-body .highlight .k,
.markdown-body .highlight .o {
  font-weight: bold;
}

.markdown-body .highlight .kt {
  color: #458;
}

.markdown-body .highlight .c,
.markdown-body .highlight .cm,
.markdown-body .highlight .c1 {
  color: #998;
  font-style: italic;
}

.markdown-body .highlight .cp,
.markdown-body .highlight .cs,
.markdown-body .highlight .cp .h {
  color: #999;
  font-weight: bold;
}

.markdown-body .highlight .cs {
  font-style: italic;
}

.markdown-body .highlight .n {
  color: #333;
}

.markdown-body .highlight .na,
.markdown-body .highlight .nv,
.markdown-body .highlight .vc,
.markdown-body .highlight .vg,
.markdown-body .highlight .vi {
  color: #008080;
}

.markdown-body .highlight .nb {
  color: #0086B3;
}

.markdown-body .highlight .nc {
  color: #458;
  font-weight: bold;
}

.markdown-body .highlight .no {
  color: #094e99;
}

.markdown-body .highlight .ni {
  color: #800080;
}

.markdown-body .highlight .ne {
  color: #990000;
  font-weight: bold;
}

.markdown-body .highlight .nf {
  color: #945277;
  font-weight: bold;
}

.markdown-body .highlight .nn {
  color: #555;
}

.markdown-body .highlight .nt {
  color: #000080;
}

.markdown-body .highlight .err {
  color: #a61717;
  background-color: #e3d2d2;
}

.markdown-body .highlight .gd {
  color: #000;
  background-color: #fdd;
}

.markdown-body .highlight .gd .x {
  color: #000;
  background-color: #faa;
}

.markdown-body .highlight .ge {
  font-style: italic;
}

.markdown-body .highlight .gr {
  color: #aa0000;
}

.markdown-body .highlight .gh {
  color: #999;
}

.markdown-body .highlight .gi {
  color: #000;
  background-color: #dfd;
}

.markdown-body .highlight .gi .x {
  color: #000;
  background-color: #afa;
}

.markdown-body .highlight .go {
  color: #888;
}

.markdown-body .highlight .gp {
  color: #555;
}

.markdown-body .highlight .gs {
  font-weight: bold;
}

.markdown-body .highlight .gu {
  color: #800080;
  font-weight: bold;
}

.markdown-body .highlight .gt {
  color: #aa0000;
}

.markdown-body .highlight .ow {
  font-weight: bold;
}

.markdown-body .highlight .w {
  color: #bbb;
}

.markdown-body .highlight .sr {
  color: #017936;
}

.markdown-body .highlight .ss {
  color: #8b467f;
}

.markdown-body .highlight .bp {
  color: #999;
}

.markdown-body .highlight .gc {
  color: #999;
  background-color: #EAF2F5;
}

.markdown-body kbd {
  background-color: #e7e7e7;
  background-image: -webkit-linear-gradient(#fefefe, #e7e7e7);
  background-image: linear-gradient(#fefefe, #e7e7e7);
  background-repeat: repeat-x;
  display: inline-block;
  padding: 3px 5px;
  font: 11px Consolas, "Liberation Mono", Menlo, Courier, monospace;
  line-height: 10px;
  color: #000;
  border: 1px solid #cfcfcf;
  border-radius: 2px;
}

.markdown-body .highlight .pl-coc,
.markdown-body .highlight .pl-entm,
.markdown-body .highlight .pl-eoa,
.markdown-body .highlight .pl-mai .pl-sf,
.markdown-body .highlight .pl-pdv,
.markdown-body .highlight .pl-sc,
.markdown-body .highlight .pl-sr,
.markdown-body .highlight .pl-v,
.markdown-body .highlight .pl-vpf {
  color: #0086b3;
}

.markdown-body .highlight .pl-eoac,
.markdown-body .highlight .pl-mdht,
.markdown-body .highlight .pl-mi1,
.markdown-body .highlight .pl-mri,
.markdown-body .highlight .pl-va,
.markdown-body .highlight .pl-vpu {
  color: #008080;
}

.markdown-body .highlight .pl-c,
.markdown-body .highlight .pl-pdc {
  color: #b4b7b4;
  font-style: italic;
}

.markdown-body .highlight .pl-k,
.markdown-body .highlight .pl-ko,
.markdown-body .highlight .pl-kolp,
.markdown-body .highlight .pl-mc,
.markdown-body .highlight .pl-mr,
.markdown-body .highlight .pl-ms,
.markdown-body .highlight .pl-s,
.markdown-body .highlight .pl-sok,
.markdown-body .highlight .pl-st {
  color: #6e5494;
}

.markdown-body .highlight .pl-ef,
.markdown-body .highlight .pl-enf,
.markdown-body .highlight .pl-enm,
.markdown-body .highlight .pl-entc,
.markdown-body .highlight .pl-eoi,
.markdown-body .highlight .pl-sf,
.markdown-body .highlight .pl-smc {
  color: #d12089;
}

.markdown-body .highlight .pl-ens,
.markdown-body .highlight .pl-eoai,
.markdown-body .highlight .pl-kos,
.markdown-body .highlight .pl-mh .pl-pdh,
.markdown-body .highlight .pl-mp,
.markdown-body .highlight .pl-pde,
.markdown-body .highlight .pl-stp {
  color: #458;
}

.markdown-body .highlight .pl-enti {
  color: #d12089;
  font-weight: bold;
}

.markdown-body .highlight .pl-cce,
.markdown-body .highlight .pl-enc,
.markdown-body .highlight .pl-kou,
.markdown-body .highlight .pl-mq {
  color: #f93;
}

.markdown-body .highlight .pl-mp1 .pl-sf {
  color: #458;
  font-weight: bold;
}

.markdown-body .highlight .pl-cos,
.markdown-body .highlight .pl-ent,
.markdown-body .highlight .pl-md,
.markdown-body .highlight .pl-mdhf,
.markdown-body .highlight .pl-ml,
.markdown-body .highlight .pl-pdc1,
.markdown-body .highlight .pl-pds,
.markdown-body .highlight .pl-s1,
.markdown-body .highlight .pl-scp,
.markdown-body .highlight .pl-sol {
  color: #df5000;
}

.markdown-body .highlight .pl-c1,
.markdown-body .highlight .pl-cn,
.markdown-body .highlight .pl-pse,
.markdown-body .highlight .pl-pse .pl-s2,
.markdown-body .highlight .pl-vi {
  color: #a31515;
}

.markdown-body .highlight .pl-mb,
.markdown-body .highlight .pl-pdb {
  color: #df5000;
  font-weight: bold;
}

.markdown-body .highlight .pl-mi,
.markdown-body .highlight .pl-pdi {
  color: #6e5494;
  font-style: italic;
}

.markdown-body .highlight .pl-ms1 {
  background-color: #f5f5f5;
}

.markdown-body .highlight .pl-mdh,
.markdown-body .highlight .pl-mdi {
  font-weight: bold;
}

.markdown-body .highlight .pl-mdr {
  color: #0086b3;
  font-weight: bold;
}

.markdown-body .highlight .pl-s2 {
  color: #333;
}

.markdown-body .highlight .pl-ii {
  background-color: #df5000;
  color: #fff;
}

.markdown-body .highlight .pl-ib {
  background-color: #f93;
}

.markdown-body .highlight .pl-id {
  background-color: #a31515;
  color: #fff;
}

.markdown-body .highlight .pl-iu {
  background-color: #b4b7b4;
}

.markdown-body .highlight .pl-mo {
  color: #969896;
}

.markdown-body .task-list-item {
  list-style-type: none;
}

.markdown-body .task-list-item+.task-list-item {
  margin-top: 3px;
}

.markdown-body .task-list-item input {
  float: left;
  margin: 0.3em 0 0.25em -1.6em;
  vertical-align: middle;
}</style><title>README</title></head><body><article class="markdown-body"><h1>
<a id="user-content-nodejs-mock-api-proxy" class="anchor" href="#nodejs-mock-api-proxy" aria-hidden="true"><span class="octicon octicon-link"></span></a>Node.js Mock API Proxy</h1>

<p>The purpose of this API Proxy is to provide the tools to develop API proxies with mocks.</p>

<h4>
<a id="user-content-what-is-the-use-case-for-this" class="anchor" href="#what-is-the-use-case-for-this" aria-hidden="true"><span class="octicon octicon-link"></span></a>What is the use case for this?</h4>

<p>It is common when building APIs to start testing, design, and development without a backend. Also, even when the backend is ready, you may want continue to run tests in isolation, without hitting the backend. The following image describes the process of testing using mock HTTP responses. However, this is easier to say than done when the solution is built from scratch. In this tutorial, I'll be providing some recommendations in terms of frameworks and a reference architecture to implement this approach based on best practices.</p>

<p><a href="https://camo.githubusercontent.com/67d1b7300ab0282553eaa583b329f67146e1be3c/68747470733a2f2f7777772e64726f70626f782e636f6d2f732f636c767463663331636675336a39632f485454502532304d6f636b696e672e706e673f646c3d31" target="_blank"><img src="https://camo.githubusercontent.com/67d1b7300ab0282553eaa583b329f67146e1be3c/68747470733a2f2f7777772e64726f70626f782e636f6d2f732f636c767463663331636675336a39632f485454502532304d6f636b696e672e706e673f646c3d31" alt="HTTP Mocking" title="HTTP Mocking" data-canonical-src="https://www.dropbox.com/s/clvtcf31cfu3j9c/HTTP%20Mocking.png?dl=1" style="max-width:100%;"></a></p>

<h4>
<a id="user-content-a-few-recommendations" class="anchor" href="#a-few-recommendations" aria-hidden="true"><span class="octicon octicon-link"></span></a>A few recommendations</h4>

<h5>
<a id="user-content-recommendation-1" class="anchor" href="#recommendation-1" aria-hidden="true"><span class="octicon octicon-link"></span></a>Recommendation #1</h5>

<p>The first recommendation before building response mocks is to avoid as much as possible to reinvent the wheel by storing the responses in a separate server of the API Proxy. Instead, keep it simple by storing them in separate Node.js modules. In this way, you'll reduce the impact on latency significantly. This approach is also useful, given that from a testing standpoint, you will want to test the API Management layer in isolation from the backend.</p>

<h5>
<a id="user-content-try-to-leverage-a-mock-framework" class="anchor" href="#try-to-leverage-a-mock-framework" aria-hidden="true"><span class="octicon octicon-link"></span></a>Try to leverage a Mock Framework</h5>

<p>In this solution, we're be leveraging <a href="https://github.com/pgte/nock">Nock</a>. Nock has built-in capabilities to store HTTP responses along with request parameters, header, and the functionality to disable requests to the backend. The main benefit of leveraging a framework such as Nock is the ability to build the API as close as possible to the final solution. Therefore, less rework will be needed to wire up the API to the actual backend when it becomes available.</p>

<h4>
<a id="user-content-getting-started" class="anchor" href="#getting-started" aria-hidden="true"><span class="octicon octicon-link"></span></a>Getting started</h4>

<h5>
<a id="user-content-step-1-make-requests-to-the-backend-as-usual-if-available" class="anchor" href="#step-1-make-requests-to-the-backend-as-usual-if-available" aria-hidden="true"><span class="octicon octicon-link"></span></a>Step 1: Make requests to the backend as usual if available</h5>

<p>The following code shows nothing unusual; it's a standard express route to /artists/:artist_name, which executes an HTTP request to the backend. If the backend is not available, in the next step you'll find how to wire up to a dummy backend in the mock responses. </p>

<div class="highlight highlight-javascript"><pre><span class="pl-c">//app.js</span>
app.get(<span class="pl-s"><span class="pl-pds">'</span>/artists/:artist_name<span class="pl-pds">'</span></span>, <span class="pl-k">function</span>(<span class="pl-smi">req</span>, <span class="pl-smi">res</span>, <span class="pl-smi">body</span>){
    <span class="pl-k">var</span> artist_name <span class="pl-k">=</span> req.params.artist_name;
    request(<span class="pl-s"><span class="pl-pds">'</span>http://lyrics.wikia.com/api.php?artist=<span class="pl-pds">'</span></span> <span class="pl-k">+</span> artist_name <span class="pl-k">+</span> <span class="pl-s"><span class="pl-pds">'</span>&amp;fmt=json<span class="pl-pds">'</span></span>, <span class="pl-k">function</span> (<span class="pl-smi">error</span>, <span class="pl-smi">response</span>, <span class="pl-smi">body</span>) {
      <span class="pl-k">if</span> (<span class="pl-k">!</span>error <span class="pl-k">&amp;&amp;</span> response.statusCode <span class="pl-k">===</span> <span class="pl-c1">200</span>) {
          <span class="pl-c">//console.log(response.headers)</span>
        res.writeHead(<span class="pl-c1">200</span>, {<span class="pl-s"><span class="pl-pds">'</span>Content-Type<span class="pl-pds">'</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">'</span>application/json;charset=utf-8<span class="pl-pds">'</span></span>,
            <span class="pl-s"><span class="pl-pds">'</span>x-nock<span class="pl-pds">'</span></span><span class="pl-k">:</span> response.<span class="pl-c1">headers</span>[<span class="pl-s"><span class="pl-pds">'</span>x-nock<span class="pl-pds">'</span></span>] <span class="pl-k">||</span> <span class="pl-s"><span class="pl-pds">'</span>false<span class="pl-pds">'</span></span>});
        res.end(body);
      }
    })
})</pre></div>

<h5>
<a id="user-content-step-2-record-mocks-with-backend-responses" class="anchor" href="#step-2-record-mocks-with-backend-responses" aria-hidden="true"><span class="octicon octicon-link"></span></a>Step 2: Record Mocks with Backend Responses</h5>

<p>The file artists.js under node/nock folder contains a few entries of mock responses. In our case, there will be three artists with mocks: Radiohead, Depeche Mode, and Juanes. At this point, you can assign the endpoint in the backend that will be intercepted by Nock and generate the response instead of sending the request to the backend.</p>

<div class="highlight highlight-javascript"><pre><span class="pl-c">//artists.js located in nock folder</span>
nock(<span class="pl-s"><span class="pl-pds">'</span>http://lyrics.wikia.com:80<span class="pl-pds">'</span></span>, options)
  .persist()
  .get(<span class="pl-s"><span class="pl-pds">'</span>/api.php?artist=radiohead&amp;fmt=json<span class="pl-pds">'</span></span>)
  .reply(<span class="pl-c1">200</span>, {<span class="pl-s"><span class="pl-pds">"</span>artist<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>Radiohead<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>albums<span class="pl-pds">"</span></span><span class="pl-k">:</span>[{<span class="pl-s"><span class="pl-pds">"</span>album<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>Pablo Honey<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>year<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>1993<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>amazonLink<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>http://www.amazon.com/exec/obidos/redirect?link_code=ur2&amp;tag=wikia-20&amp;camp=1789&amp;creative=9325&amp;path=external-search%3Fsearch-type=ss%26index=music%26keyword=Radiohead%20Pablo%20Honey<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>songs<span class="pl-pds">"</span></span><span class="pl-k">:</span>[<span class="pl-s"><span class="pl-pds">"</span>You<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>Creep<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>How Do You?<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>Stop Whispering<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>Thinking About You<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>Anyone Can Play Guitar<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>Ripcord<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>Vegetable<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>Prove Yourself<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>I Can't<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>Lurgee<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>Blow Out<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>Creep (Clean)<span class="pl-pds">"</span></span>]}...]}, </pre></div>

<p>As you can see, responses not only include the response content but also response code and headers. Nock also has the facilities to record backend responses when the backend is available.</p>

<p>Note persist() this will allow the nock to be reused. Otherwise, one nock can only be used once.</p>

<h5>
<a id="user-content-step-3--enable-nock-based-on-x-enable-nock-header" class="anchor" href="#step-3--enable-nock-based-on-x-enable-nock-header" aria-hidden="true"><span class="octicon octicon-link"></span></a>Step 3:  Enable Nock based on X-Enable-Nock Header</h5>

<p>The following Express middleware function determines whether or not to send the request to the backend by calling 'nockHelper.enableNock' function with true or false.</p>

<div class="highlight highlight-javascript"><pre>app.use(<span class="pl-k">function</span> (<span class="pl-smi">req</span>, <span class="pl-smi">res</span>, <span class="pl-smi">next</span>) {
    <span class="pl-s"><span class="pl-pds">"</span>use strict<span class="pl-pds">"</span></span>;
    <span class="pl-k">if</span>(req.header(<span class="pl-s"><span class="pl-pds">'</span>X-Enable-Nock<span class="pl-pds">'</span></span>) <span class="pl-k">&amp;&amp;</span> req.header(<span class="pl-s"><span class="pl-pds">'</span>X-Enable-Nock<span class="pl-pds">'</span></span>) <span class="pl-k">===</span> <span class="pl-s"><span class="pl-pds">'</span>true<span class="pl-pds">'</span></span>) {
        <span class="pl-c">//console.log('enabling nock');</span>
        nockHelper.enableNock(<span class="pl-c1">true</span>);
    }
    <span class="pl-k">else</span> <span class="pl-k">if</span>(<span class="pl-k">!</span>req.header(<span class="pl-s"><span class="pl-pds">'</span>X-Enable-Nock<span class="pl-pds">'</span></span>) <span class="pl-k">||</span> req.header(<span class="pl-s"><span class="pl-pds">'</span>X-Enable-Nock<span class="pl-pds">'</span></span>) <span class="pl-k">===</span> <span class="pl-s"><span class="pl-pds">'</span>false<span class="pl-pds">'</span></span>) {
        <span class="pl-c">//console.log('disabling nock');</span>
        nockHelper.enableNock(<span class="pl-c1">false</span>);
    }
    next();
});</pre></div>

<h5>
<a id="user-content-test-it" class="anchor" href="#test-it" aria-hidden="true"><span class="octicon octicon-link"></span></a>Test it</h5>

<pre><code>curl -X GET -H "X-Enable-Nock: true" https://testmyapi-test.apigee.net/nodejs-mock-api-proxy/artists/juanes
</code></pre>

<p>Try other artists: Radiohead and Depeche Mode. 
Verify the response contains x-nock header set to true and false when X-Enable-Nock is set to false.</p>

<h5>
<a id="user-content-generate-mocks-from-existing-backend" class="anchor" href="#generate-mocks-from-existing-backend" aria-hidden="true"><span class="octicon octicon-link"></span></a>Generate Mocks from existing Backend</h5>

<p>nockHelper.generateMocks(true) in app.js will save all nock responses in records.js in nock folder.</p>

<h5>
<a id="user-content-deploy-it-in-your-org" class="anchor" href="#deploy-it-in-your-org" aria-hidden="true"><span class="octicon octicon-link"></span></a>Deploy it in your org</h5>

<p>This API can be deployed in your org by following instruction from (Apigee Deploy Grunt Plugin)[<a href="https://github.com/apigeecs/apigee-deploy-grunt-plugin#steps-to-get-started-deprecated">https://github.com/apigeecs/apigee-deploy-grunt-plugin#steps-to-get-started-deprecated</a>].</p>
</article></body></html>